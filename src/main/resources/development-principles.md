# Todo Agent Starter - 开发原则

## 项目概述
本项目是一个基于 Spring Boot 和 AI 技术的 Todo 管理系统，集成了 Model Context Protocol (MCP) 用于 AI Agent 交互。

## 1. 代码质量原则 (Code Quality Principles)

### 1.1 代码规范
- **命名规范**: 使用有意义的英文命名，类名采用 PascalCase，方法和变量采用 camelCase
- **注释标准**: 每个公共方法必须有 Javadoc 注释，复杂逻辑需要行内注释
- **包结构**: 严格按照分层架构组织包结构 (controller, service, repository, entity, dto, exception)
- **代码复用**: 避免重复代码，提取公共方法和工具类

### 1.2 设计原则
- **单一职责原则**: 每个类和方法只负责一个功能
- **开闭原则**: 对扩展开放，对修改封闭
- **依赖注入**: 使用 Spring 的依赖注入，避免 new 关键字创建对象
- **异常处理**: 使用全局异常处理器，统一异常处理逻辑

### 1.3 AI 工具集成标准
- **@Tool 注解**: 所有暴露给 AI 的方法必须使用 @Tool 注解并提供清晰的描述
- **参数验证**: AI 工具方法必须进行严格的参数验证
- **返回值一致性**: 保持返回值格式的一致性，便于 AI 理解和处理

## 2. 测试标准 (Testing Standards)

### 2.1 测试覆盖率
- **单元测试**: 所有 Service 层方法必须有单元测试，覆盖率不低于 80%
- **集成测试**: 所有 Controller 和 Repository 必须有集成测试
- **AI 工具测试**: 所有带 @Tool 注解的方法必须有专门的测试用例

### 2.2 测试实践
- **测试命名**: 测试方法名应清晰表达测试意图，格式：`should_ExpectedBehavior_When_StateUnderTest`
- **测试数据**: 使用 @TestConfiguration 和 @MockBean 管理测试数据
- **断言明确**: 使用具体的断言，避免通用的 assertTrue/assertFalse

### 2.3 测试分类
```java
// 单元测试示例
@ExtendWith(MockitoExtension.class)
class TodoServiceTest {
    @Test
    void should_ReturnTodo_When_CreateWithValidData() {
        // Given, When, Then
    }
}

// 集成测试示例
@SpringBootTest
@AutoConfigureTestDatabase
class TodoControllerIntegrationTest {
    // 测试 REST API 和数据库交互
}
```

## 3. 用户体验一致性 (User Experience Consistency)

### 3.1 API 设计原则
- **RESTful 设计**: 遵循 REST 架构风格，使用标准 HTTP 方法
- **统一响应格式**: 所有 API 返回统一的响应格式
```json
{
  "success": true,
  "data": {...},
  "message": "操作成功",
  "timestamp": "2025-10-15T10:30:00Z"
}
```

### 3.2 错误处理一致性
- **HTTP 状态码**: 正确使用 HTTP 状态码 (200, 201, 400, 404, 500)
- **错误信息**: 提供清晰、用户友好的错误信息
- **国际化支持**: 错误信息支持多语言

### 3.3 AI 交互体验
- **自然语言理解**: AI 工具描述使用自然、易懂的语言
- **操作反馈**: 每个 AI 操作都应提供明确的反馈信息
- **容错处理**: 对于 AI 输入的模糊性和错误要有良好的处理机制

## 4. 性能要求 (Performance Requirements)

### 4.1 响应时间标准
- **API 响应时间**: 95% 的请求响应时间不超过 200ms
- **数据库查询**: 单次查询时间不超过 100ms
- **AI 工具调用**: AI 工具方法执行时间不超过 500ms

### 4.2 并发处理
- **连接池配置**: 合理配置数据库连接池大小
- **缓存策略**: 对频繁查询的数据使用适当的缓存机制
- **异步处理**: 对于耗时操作使用异步处理

### 4.3 资源管理
- **内存使用**: 避免内存泄漏，及时释放不必要的资源
- **数据库优化**: 使用索引优化查询，避免 N+1 查询问题
- **日志管理**: 合理设置日志级别，避免过多的日志输出影响性能

## 5. 安全要求 (Security Requirements)

### 5.1 数据验证
- **输入验证**: 所有用户输入必须进行验证和清理
- **SQL 注入防护**: 使用参数化查询，避免 SQL 注入
- **XSS 防护**: 对输出数据进行适当的转义

### 5.2 AI 安全
- **工具权限**: 限制 AI 工具的访问权限，避免敏感操作
- **输入过滤**: 对 AI 输入进行安全过滤和验证
- **审计日志**: 记录所有 AI 工具的调用日志

## 6. 开发流程 (Development Workflow)

### 6.1 代码提交规范
```
feat: 添加新功能
fix: 修复 bug
docs: 文档更新
style: 代码格式调整
refactor: 代码重构
test: 测试相关
chore: 构建工具或依赖更新
```

### 6.2 代码审查要点
- 代码是否符合设计原则
- 测试覆盖率是否达标
- 性能是否满足要求
- 安全问题检查
- AI 工具集成是否正确

### 6.3 发布流程
1. 完成功能开发和测试
2. 代码审查通过
3. 集成测试通过
4. 性能测试通过
5. 部署到测试环境验证
6. 生产环境发布

## 7. 监控和维护 (Monitoring & Maintenance)

### 7.1 应用监控
- **健康检查**: 实现应用健康检查端点
- **性能指标**: 监控关键性能指标 (响应时间、吞吐量、错误率)
- **日志分析**: 定期分析日志，发现潜在问题

### 7.2 AI 系统监控
- **工具调用统计**: 监控 AI 工具的调用频率和成功率
- **性能分析**: 分析 AI 工具的执行性能
- **错误追踪**: 追踪和分析 AI 相关的错误

---

**版本**: 1.0  
**创建日期**: 2025-10-15  
**最后更新**: 2025-10-15  
**维护者**: 开发团队
